name: Build

on:
    push:
        branches: [ main ]
    pull_request:
        branches: [ main ]
    schedule:
        # 06:00 every saturday:
        - cron:  '0 6 * * 6'
          branches: [ main ]
jobs:
    build:
        runs-on: ubuntu-latest
        steps:
           - name: Checkout source
             uses: actions/checkout@v2
           - name: Set up JDK 1.8
             uses: actions/setup-java@v1
             with:
                 java-version: 1.8
                 server-id: testossrh
                 server-username: OSSRH_USER
                 server-password: OSSRH_PASSWORD
                 gpg-private-key: ${{secrets.GPG_SECRET_KEY}}
                 gpg-passphrase: GPG_SECRET_KEY_PASSPHRASE
           - name: Show Maven setting
             run: cat /home/runner/.m2/settings.xml
           - name: Build with Maven
             run: mvn --batch-mode clean install
             env:
                 GPG_SECRET_KEY_PASSPHRASE: ${{secrets.GPG_SECRET_KEY_PASSPHRASE}}
